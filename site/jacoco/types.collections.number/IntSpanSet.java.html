<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>IntSpanSet.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jmeos</a> &gt; <a href="index.source.html" class="el_package">types.collections.number</a> &gt; <span class="el_source">IntSpanSet.java</span></div><h1>IntSpanSet.java</h1><pre class="source lang-java linenums">package types.collections.number;
import jnr.ffi.annotations.In;
import types.collections.base.Base;
import types.collections.base.SpanSet;
import jnr.ffi.Pointer;
import functions.functions;

import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;


/**
 * Class for representing lists of disjoint intspans.
 * &lt;p&gt;
 *     ``IntSpanSet`` objects can be created with a single argument of type string
 *     as in MobilityDB.
 * &lt;p&gt;
 *         &gt;&gt;&gt; IntSpanSet(string='{[8, 10], [11, 12]}')
 * &lt;p&gt;
 *     Another possibility is to give a list specifying the composing
 *     spans, which can be instances  of ``str`` or ``IntSpan``. The composing
 *     spans must be given in increasing order.
 * &lt;p&gt;
 *         &gt;&gt;&gt; IntSpanSet(span_list=['[8, 10]', '[11, 12]'])
 *         &gt;&gt;&gt; IntSpanSet(span_list=[IntSpan('[8, 10]'), IntSpan('[11, 12]')])
 *
 * @author ARIJIT SAMAL
 */
public class IntSpanSet extends SpanSet&lt;Integer&gt; implements Number{
    private final Pointer _inner;


    /** ------------------------- Constructors ---------------------------------- */

    public IntSpanSet(Pointer inner){
<span class="fc" id="L40">        super(inner);</span>
<span class="fc" id="L41">        _inner = inner;</span>
<span class="fc" id="L42">    }</span>

    public IntSpanSet(String str){
<span class="fc" id="L45">        super(str);</span>
<span class="fc" id="L46">        this._inner = functions.intspanset_in(str);</span>
<span class="fc" id="L47">    }</span>


    @Override
    public Pointer createStringInner(String str){
<span class="fc" id="L52">        return functions.intspanset_in(str);</span>
    }

    @Override
    public Pointer createInner(Pointer inner){
<span class="fc" id="L57">        return inner;</span>
    }

//    @Override
//    public Pointer createListInner(List&lt;tstzspan&gt; periods){
//        return null;
//    }

    /* ------------------------- Output ---------------------------------------- */


    /**
     * Return the string representation of the content of &quot;this&quot;.
     *
     *  &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;intspanset_out&lt;/li&gt;
     *
     *
     * @return A new {@link String} instance
     */
    public String toString(){
<span class="fc" id="L79">        return functions.intspanset_out(this._inner);</span>
    }


    /* ------------------------- Conversions ----------------------------------- */


    /**
     * Returns a span that encompasses &quot;this&quot;.
     *
     * &lt;p&gt;
     * &lt;p&gt;
     * MEOS Functions:
     * &lt;li&gt;spanset_span&lt;/li&gt;
     *
     * @return A new {@link IntSpan} instance
     */
    public IntSpan to_span(){
<span class="fc" id="L97">        return new IntSpan(functions.spanset_span(this._inner));</span>
    }

    /**
     * Returns an intspanset that encompasses &quot;this&quot;.
     *
     * &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;intspanset_floatspanset&lt;/li&gt;
     *
     * @return A new {@link FloatSpanSet} instance
     */

    public FloatSpanSet to_floatspanset(){
<span class="fc" id="L112">        return new FloatSpanSet(functions.intspanset_to_floatspanset(this._inner));</span>
    }





    /** ------------------------- Accessors ------------------------------------- */

    public  Pointer get_inner(){
<span class="fc" id="L122">        return _inner;</span>
    }

    /**
     * Returns the width of the spanset. By default, i.e., when the second
     *         argument is False, the function takes into account the gaps within,
     *         i.e., returns the sum of the widths of the spans within.
     *         Otherwise, the function returns the width of the spanset ignoring
     *         any gap, i.e., the width from the lower bound of the first span to
     *         the upper bound of the last span.
     * &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;spanset_width&lt;/li&gt;
     *
     * @param ignore_gaps Whether to take into account potential gaps in
     *      *             the spanset.
     * @return A `float` representing the duration of the spanset
     */
    public int width(boolean ignore_gaps){
<span class="fc" id="L141">        return functions.intspanset_width(this._inner, ignore_gaps);</span>
    }

    /*
      Returns the first span in &quot;this&quot;.
      &lt;p&gt;
              MEOS Functions:
                  &lt;li&gt;spanset_start_span&lt;/li&gt;

      @return A {@link IntSpan} instance
     */
    public IntSpan start_span(){
<span class="fc" id="L153">        return new IntSpan(functions.spanset_start_span(this._inner));</span>
    }

    /*
      Returns the last span in &quot;this&quot;.
      &lt;p&gt;
              MEOS Functions:
                  &lt;li&gt;spanset_end_span&lt;/li&gt;

      @return A {@link IntSpan} instance
     */
    public IntSpan end_span(){
<span class="fc" id="L165">        return new IntSpan(functions.spanset_end_span(this._inner));</span>
    }

    /*
      Returns the n-th span in &quot;this&quot;.
      &lt;p&gt;
              MEOS Functions:
                  &lt;li&gt;spanset_span_n&lt;/li&gt;

      @return A {@link IntSpan} instance
     */
    public IntSpan span_n(int n){
<span class="fc" id="L177">        return new IntSpan(functions.spanset_span_n(this._inner, n));</span>
    }


    public List&lt;IntSpan&gt; spans(){
<span class="fc" id="L182">        Pointer ps = functions.spanset_spans(this._inner);</span>
<span class="fc" id="L183">        List&lt;IntSpan&gt; spanList = new ArrayList&lt;IntSpan&gt;();</span>
<span class="fc" id="L184">        System.out.println(this.num_spans());</span>
<span class="fc" id="L185">        long pointerSize= Long.BYTES;</span>
<span class="fc bfc" id="L186" title="All 2 branches covered.">        for (long i=0; i&lt;this.num_spans(); i++){</span>
<span class="fc" id="L187">            Pointer p= ps.getPointer((long) i*pointerSize);</span>
//            System.out.println(new IntSpan(p).lower().toString());
//            System.out.println(new IntSpan(p).upper().toString());
<span class="fc" id="L190">            spanList.add(new IntSpan(p));</span>
        }
//        System.out.println(spanList);
<span class="fc" id="L193">        return spanList;</span>
    }
    /* ------------------------- Transformations ------------------------------- */


    /**
     * Return a new &quot;IntSpanSet&quot; with the lower and upper bounds shifted by
     *         &quot;delta&quot;.
     *
     *  &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;floatspanset_shift_scale&lt;/li&gt;
     *
     *
     * @param delta The value to shift by
     * @return A new {@link IntSpanSet} instance
     */

    public IntSpanSet shift(int delta){
<span class="fc" id="L212">        return this.shift_scale(delta,0);</span>
    }


    /**
     * Return a new &quot;IntSpanSet&quot; with the lower and upper bounds scaled so
     *         that the width is &quot;width&quot;.
     *
     *  &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;floatspanset_shift_scale&lt;/li&gt;
     *
     * @param width The new width
     * @return a new {@link IntSpanSet} instance
     */

    public IntSpanSet scale(int width){
<span class="fc" id="L229">        return this.shift_scale(0,width);</span>
    }



    /**
     * Return a new &quot;IntSpanSet&quot; with the lower and upper bounds shifted by
     *         &quot;delta&quot; and scaled so that the width is &quot;width&quot;.
     *
     *  &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;floatspanset_shift_scale&lt;/li&gt;
     *
     * @param delta The value to shift by
     * @param width v
     * @return a new {@link IntSpanSet} instance
     */

    public IntSpanSet shift_scale(int delta, int width){
<span class="fc bfc" id="L248" title="All 4 branches covered.">        return new IntSpanSet(functions.intspanset_shift_scale(this._inner,delta,width,delta != 0,width!=0));</span>
    }






    /* ------------------------- Topological Operations -------------------------------- */


    /**
     * Returns whether &quot;this&quot; is adjacent to &quot;other&quot;. That is, they share
     *         a bound but only one of them contains it.
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;adjacent_spanset_span&lt;/li&gt;
     *             &lt;li&gt;adjacent_spanset_spanset&lt;/li&gt;
     *             &lt;li&gt;adjacent_intspanset_int&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if adjacent, False otherwise
     * @throws Exception
     */
    public boolean is_adjacent(Object other) throws Exception {
<span class="fc" id="L275">        boolean answer = false;</span>
<span class="pc bpc" id="L276" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L277">            answer = functions.adjacent_spanset_int(this._inner, (int) other);</span>
        }
        else{
<span class="nc" id="L280">            answer = super.is_adjacent((Base)other);</span>
        }
<span class="fc" id="L282">        return answer;</span>
    }

    /**
     * Returns whether &quot;this&quot; contains &quot;content&quot;.
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;contains_spanset_span&lt;/li&gt;
     *             &lt;li&gt;contains_spanset_spanset&lt;/li&gt;
     *             &lt;li&gt;contains_intspanset_float&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if contains, False otherwise
     * @throws Exception
     */
    public boolean contains(Object other) throws Exception {
<span class="fc" id="L300">        boolean answer = false;</span>
<span class="pc bpc" id="L301" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L302">            answer = functions.contains_spanset_int(this._inner, (int) other);</span>
        }
        else{
<span class="nc" id="L305">            answer = super.contains((Base)other);</span>
        }
<span class="fc" id="L307">        return answer;</span>
    }


    /**
     * Returns whether &quot;this&quot; and the bounding period of &quot;other&quot; is the
     *         same.
     *
     * &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;same_period_temporal&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if equal, False otherwise
     * @throws Exception
     */
    public boolean is_same(Object other) throws Exception {
<span class="pc bpc" id="L324" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L325">            return functions.spanset_eq(this._inner,functions.int_to_spanset((int) other));</span>
        }
        else{
<span class="nc" id="L328">            return super.is_same((Base)other);</span>
        }
    }


    /* ------------------------- Position Operations --------------------------- */

    /**
     * Returns whether &quot;this&quot; is strictly left of &quot;other&quot;. That is,
     *         &quot;this&quot; ends before &quot;other&quot; starts.
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;left_span_span&lt;/li&gt;
     *             &lt;li&gt;left_span_spanset&lt;/li&gt;
     *             &lt;li&gt;left_intspanset_int&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if left, False otherwise
     * @throws Exception
     */
    public boolean is_left(Object other) throws Exception {
<span class="fc" id="L351">        boolean answer = false;</span>
<span class="pc bpc" id="L352" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L353">            answer = functions.left_spanset_int(this._inner,(int) other);</span>
        }
        else{
<span class="nc" id="L356">            answer = super.is_left((Base)other);</span>
        }
<span class="fc" id="L358">        return answer;</span>
    }


    /**
     * Returns whether &quot;this&quot; is left &quot;other&quot; allowing overlap. That is,
     *         &quot;this&quot; ends before &quot;other&quot; ends (or at the same value).
     *
     * &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;overleft_span_span&lt;/li&gt;
     *             &lt;li&gt;overleft_span_spanset&lt;/li&gt;
     *             &lt;li&gt;overleft_intspanset_int&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if before, False otherwise
     * @throws Exception
     */
    public boolean is_over_or_left(Object other) throws Exception {
<span class="fc" id="L378">        boolean answer = false;</span>
<span class="pc bpc" id="L379" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L380">            answer = functions.overleft_spanset_int(this._inner,(int) other);</span>
        }
        else{
<span class="nc" id="L383">            answer = super.is_over_or_left((Base)other);</span>
        }
<span class="fc" id="L385">        return answer;</span>
    }


    /**
     * Returns whether &quot;this&quot; is strictly right &quot;other&quot;. That is, &quot;this&quot;
     *         starts after &quot;other&quot; ends.
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;right_span_span&lt;/li&gt;
     *             &lt;li&gt;right_span_spanset&lt;/li&gt;
     *             &lt;li&gt;right_intspan_int&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if right, False otherwise
     * @throws Exception
     */
    public boolean is_right(Object other) throws Exception {
<span class="fc" id="L405">        boolean answer = false;</span>
<span class="pc bpc" id="L406" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L407">            answer = functions.right_spanset_int(this._inner,(int) other);</span>
        }
        else{
<span class="nc" id="L410">            answer = super.is_right((Base)other);</span>
        }
<span class="fc" id="L412">        return answer;</span>
    }



    /**
     *  Returns whether &quot;this&quot; is right &quot;other&quot; allowing overlap. That is,
     *         &quot;this&quot; starts after &quot;other&quot; starts (or at the same value).
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;overright_spanset_span&lt;/li&gt;
     *             &lt;li&gt;overright_spanset_spanset&lt;/li&gt;
     *             &lt;li&gt;overright_intspanset_int&lt;/li&gt;
     *
     * @param other object to compare with
     * @return True if overlapping or after, False otherwise
     * @throws Exception
     */
    public boolean is_over_or_right(Object other) throws Exception {
<span class="fc" id="L433">        boolean answer = false;</span>
<span class="pc bpc" id="L434" title="1 of 2 branches missed.">        if (other instanceof Integer){</span>
<span class="fc" id="L435">            answer = functions.overright_spanset_int(this._inner,(int) other);</span>
        }
        else{
<span class="nc" id="L438">            answer = super.is_over_or_right((Base)other);</span>
        }
<span class="fc" id="L440">        return answer;</span>
    }



    /* ------------------------- Distance Operations --------------------------- */

    /**
     * Returns the distance between &quot;this&quot; and &quot;other&quot;.
     *
     *   &lt;p&gt;
     *         MEOS Functions:
     *             &lt;li&gt;distance_spanset_span&lt;/li&gt;
     *             &lt;li&gt;distance_spanset_spanset&lt;/li&gt;
     *             &lt;li&gt;distance_intspanset_int&lt;/li&gt;
     *
     * @param other object to compare with
     * @return A float value
     * @throws Exception
     */
    public float distance(Object other) throws Exception {
<span class="nc" id="L461">        float answer = 0;</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">        if (other instanceof Integer) {</span>
<span class="nc" id="L463">            answer = (float) functions.distance_spanset_int(this._inner, (int) other);</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">        } else if (other instanceof IntSet) {</span>
<span class="nc" id="L465">            IntSpan is = ((IntSet) other).to_span(IntSpan.class);</span>
<span class="nc" id="L466">            answer = (float) functions.distance_intspanset_intspan(this._inner, (is).get_inner());</span>
<span class="nc bnc" id="L467" title="All 2 branches missed.">        } else if (other instanceof IntSpan) {</span>
<span class="nc" id="L468">            answer = (float) functions.distance_intspanset_intspan(this._inner, ((IntSpan) other).get_inner());</span>
<span class="nc bnc" id="L469" title="All 2 branches missed.">        } else if (other instanceof IntSpanSet) {</span>
<span class="nc" id="L470">            answer = (float) functions.distance_intspanset_intspanset(this._inner, ((IntSpanSet) other).get_inner());</span>
        } else {
<span class="nc" id="L472">            throw new Exception(&quot;Operation not supported with &quot; + other + &quot; type&quot;);</span>
        }
<span class="nc" id="L474">        return answer;</span>
    }







    /**
     * ------------------------- Set Operations --------------------------------
     */


    public IntSpanSet intersection(Object other) throws Exception {
<span class="fc" id="L489">        Pointer result = null;</span>
<span class="fc bfc" id="L490" title="All 2 branches covered.">        if (other instanceof Integer){</span>
<span class="fc" id="L491">            result= functions.intersection_spanset_int(this._inner, (int) other);</span>
        }
        else{
<span class="fc" id="L494">            IntSpanSet tmp= (IntSpanSet) super.intersection((Base) other);</span>
<span class="fc" id="L495">            result= tmp.get_inner();</span>
        }
<span class="fc" id="L497">        return new IntSpanSet(result);</span>
    }

    public IntSpanSet mul(int other) throws Exception {
<span class="nc" id="L501">        return this.intersection(other);</span>
    }


    /**
     * Returns the difference of &quot;this&quot; and &quot;other&quot;.
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;minus_spanset_span&lt;/li&gt;
     *             &lt;li&gt;minus_spanset_spanset&lt;/li&gt;
     *             &lt;li&gt;minus_intspanset_int&lt;/li&gt;
     *
     * @param other object to diff with
     * @return  A {@link IntSpanSet} instance.
     * @throws Exception
     */
    public IntSpanSet minus(Object other) throws Exception {
<span class="fc" id="L520">        Pointer result = null;</span>
<span class="pc bpc" id="L521" title="1 of 4 branches missed.">        if ((other instanceof Integer) || (other instanceof Float)){</span>
<span class="fc" id="L522">            result = functions.minus_spanset_int(this._inner, (int) other);</span>
        }
        else{
<span class="fc" id="L525">            IntSpanSet tmp = (IntSpanSet) super.minus((Base) other);</span>
<span class="fc" id="L526">            result = tmp.get_inner();</span>
        }
<span class="fc" id="L528">        return new IntSpanSet(result);</span>
    }


    public IntSpanSet sub(int other) throws Exception {
<span class="nc" id="L533">        return this.minus(other);</span>
    }



    /**
     * Returns the union of &quot;this&quot; and &quot;other&quot;.
     *
     *  &lt;p&gt;
     *
     *         MEOS Functions:
     *             &lt;li&gt;union_intspanset_int&lt;/li&gt;
     *             &lt;li&gt;union_spanset_spanset&lt;/li&gt;
     *             &lt;li&gt;union_spanset_span&lt;/li&gt;
     *
     * @param other object to merge with
     * @return A {@link IntSpanSet} instance.
     */

    public IntSpanSet union(Object other) throws Exception {
<span class="fc" id="L553">        Pointer result = null;</span>
<span class="pc bpc" id="L554" title="1 of 4 branches missed.">        if ((other instanceof Integer) || (other instanceof Float)){</span>
<span class="fc" id="L555">            result = functions.union_spanset_int(this._inner, (int) other);</span>
        }
        else{
<span class="fc" id="L558">            IntSpanSet tmp = (IntSpanSet) super.minus((Base) other);</span>
<span class="fc" id="L559">            result = tmp.get_inner();</span>
        }
<span class="fc" id="L561">        return new IntSpanSet(result);</span>

    }

    public IntSpanSet add(int other) throws Exception {
<span class="nc" id="L566">        return this.union(other);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>